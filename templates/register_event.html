@app.route("/register/event/<int:candidate_id>", methods=["GET", "POST"])
def register_event(candidate_id):
    candidate = Candidate.query.get_or_404(candidate_id)

    # Confirmed が存在しない場合は自動作成
    event = Confirmed.query.filter_by(candidate_id=candidate_id).first()
    if not event:
        event = Confirmed(candidate_id=candidate_id)
        db.session.add(event)
        db.session.commit()

    members = ["松村", "山火", "山根", "奥迫", "川崎"]

    if request.method == "POST":
        att = Attendance(
            event_id=event.id,
            name=request.form["name"],
            status=request.form["status"]
        )
        db.session.add(att)
        db.session.commit()

        return redirect(url_for("register_event", candidate_id=candidate_id))

    attendance = Attendance.query.filter_by(event_id=event.id).all()

    return render_template(
        "register_form.html",
        candidate=candidate,
        attendance=attendance,
        members=members
    )
